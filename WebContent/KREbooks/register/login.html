<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="css/style.css"/>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/bootstrap-3.3.7-dist/css/bootstrap.min.css">

	<script type="text/javascript" src="js/angular.min.js"></script>
	<meta charset="UTF-8">
	<title>Registration</title>
	<script type="text/javascript">
		function focusPassword()
		{
			var chars1=/[A-Z]/;
			var chars2=/[a-z]/;
			var chars3=/[0-9]/;
			var theInput = document.getElementsByTagName("input")[2];
			var theOutput = document.getElementById("out");
			var pass = document.forms[0].pass.value;
			//theInput.style.borderWidth = "2px 2px 4px 1px";
			if(pass.length<4)
			{
				theInput.style.borderColor="red";
				theOutput.innerHTML = "Weak Password";
				theOutput.style.color="red";
			}
			else
			{
				if(((pass.match(chars1))||(pass.match(chars2)))&&(pass.match(chars3)))
				{
					theInput.style.borderColor="green";
					theOutput.innerHTML = "Strong Password";
					theOutput.style.color="green";
				}
				else
				{
					theInput.style.borderColor="yellow";
					theOutput.innerHTML = "Moderate Password";
					theOutput.style.color="yellow";
				}
			}
		}
		
		function focusPasswordCom()
		{
			var theInputPass = document.getElementsByTagName("input")[2];
			var theInput = document.getElementsByTagName("input")[3];
			if(theInputPass.value.length>0)
			{
				if(theInputPass.value.localeCompare(theInput.value) == 0)
				{
					theInput.style.borderColor="#555";
				}
				else
				{
					theInput.style.borderColor="red";
				}
			}
				
		}
	</script>
</head>
<body id="registration">
	<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script>
	var app = angular.module('Regisret', []);
	app.controller('Ctrl', function($scope,$http)
	{
		$scope.error="Error ";
		$scope.desc="";
		$scope.photo="";
		$scope.errormsgg="Username already exists, enter a new one and try again";
		$('#alert1').hide();
		$('#alert2').hide();
		$('#alert3').hide();
	    $scope.SubmitFunction = function()
	    {
	    	var correctFlag=1;
	    	$('#alert1').hide();
	    	$('#alert2').hide();
	    	$('#alert3').hide();
	    	if($scope.pwd.length<3)
	    	{
	    		correctFlag=0;
	    		$scope.error="Error ";
	    		$scope.errormsg3="Your passwords to short (min chars 3)";
	    		$('#alert3').show();
	    	}
		    if($scope.pwd.length>8)
	    	{
	    		correctFlag=0;
	    		$scope.error="Error ";
	    		$scope.errormsg3="Your passwords is too long");
	    		$('#alert3').show();
	    	}
			if($scope.name.length>10)
	    	{
	    		correctFlag=0;
	    		$scope.error="Error ";
	    		$scope.errormsg3="Your name is too long";
	    		$('#alert3').show();
	    	}
			if($scope.surname.length>10)
	    	{
	    		correctFlag=0;
	    		$scope.error="Error ";
	    		$scope.errormsg3="Your surname is too long";
	    		$('#alert3').show();
	    	}

	    	if(correctFlag==1)
	    	{
	    		if ($scope.photo.length==0)
	    			$scope.photo="img/defaultAvatarBig.jpg";
	    		var data =
	    		{
	    			Name: $scope.name,
					Surname: $scope.surname,
	    			Password: $scope.pwd,
					Nickname: $scope.nick,
	    			Desc: $scope.desc,
					Addr: $scope.addr,
					Email:$scope.email, 
	    			Photo: $scope.photo	
	    		}
	    		request = $.post("reg",JSON.stringify(data));
	    		request.done(function (response, textStatus, jqXHR)
	    		{
	    	        	window.location = 'welcome';
	    	    });
	    		request.fail(function() {
	    			$scope.error="Error ";
					$scope.errormsgg="Username "+$scope.usr+" already exists, enter a new one and try agai";
					$('#alert2').show();
	    		});
	    		
	    	}
	    };
	});
	</script>
	<div class="container" data-ng-app="RegLogic" data-ng-controller="Ctrl">
      <form class="form-inline" method="post">
        <h3 class="form-heading" align="center">Registration</h3>
		<br/>
        <div class="form-group" "col-sm-3">
        	<label for="usr">Name: </label>
        	<input type="text" class="form-control" placeholder="Name" id="name" maxlength="10" ng-model="name" required>
        </div><br/>
		<div class="form-group" "col-sm-3">
        	<label for="usr">Surname: </label>
        	<input type="text" class="form-control" placeholder="Surname" id="surname" maxlength="10" ng-model="surname" required>
        </div><br>
      <div class="form-group" "col-sm-3">
        	<label for="pwd">Password: </label>
        	<input type="password" name="pass" onkeypress="focusPassword()" class="form-control" placeholder="Password" id="pwd" maxlength="8" required ng-model="pwd">
        	<div class="form-group" id="out"></div>
        </div><br>
        <div class="form-group">
        	<label for="nick">Nickname: </label>
        	<input type="text" class="form-control" placeholder="Nickname" placeholder="Nickname" id="nick" maxlength="20" ng-model="nick" required>
        </div><br>
		<div class="form-group">
        	<label for="desc">Short Description: </label>
        	<textarea maxlength="300" rows="4" cols="50" class="form-control" placeholder="Tell us a little bit about yourself" id="desc" ng-model="desc"></textarea>
        </div><br>
        <div class="form-group">
        	<label for="desc">Address: </label>
        	<input type="text"  class="form-control" placeholder="Address" id="addr" ng-model="addr" required>
        </div><br>
		<div class="form-group">
        	<label for="desc">Email: </label>
        	<input type="email"  class="form-control" placeholder="Email" id="email" ng-model="email" required>
			 <div ng-message="email">Your email address is invalid</div>
        </div><br>
        <div class="form-group">
        	<label for="photo">Photo: </label>
        	<input type="text" class="form-control" id="photo" placeholder="Photo URL" ng-model="photo">
        </div><br><br>
        <button type="submit" class="btn btn-lg btn-primary " ng-click='SubmitFunction()'>Register Now</button>
      </form>
    </div>
</body>
</html>